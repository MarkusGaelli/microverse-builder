"use strict";(globalThis.webpackChunk_croquet_microverse=globalThis.webpackChunk_croquet_microverse||[]).push([[265],{4265:(s,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i={modules:[{name:"Pendulum",actorBehaviors:[class PendulumActor{setup(){this.chains=20;let e=this.chains;this.ms=[...Array(this.chains).keys()].map(s=>({m:s===this.chains-1?10:1,a:[0,0,0],v:[0,0,0],p:[.1*s,s===this.chain-1?e-1.05*s:e-1.05*(s-1)+.5,0]})),this.springs=[];for(let s=0;s<this.chains-1;s++){var t=s===this.chains-2?.5:1;this.springs.push({length:t,naturalLength:t,s0:this.ms[s],s1:this.ms[s+1]})}this.stepping||(console.log("new step"),this.stepping=!0,this.step()),this.addEventListener("pointerTap","wiggle")}step(){if(this.stepping){var e=this.chains;for(let s=0;s<e;s++)this.ms[s].a=[0,-.001,0];let i=s=>{let e=Number.isNaN;return e(s[0])||e(s[1])||e(s[2])};var r=s=>i(s.a)||i(s.v)||i(s.p);for(let t=0;t<this.springs.length;t++){var h=this.springs[t];let s=h.s0,e=h.s1;var a=s.p,o=e.p,o=[o[0]-a[0],o[1]-a[1],o[2]-a[2]],a=Worldcore.v3_magnitude(o)-h.naturalLength,h=Worldcore.v3_scale(o,.3*a*e.m),o=Worldcore.v3_scale(o,.3*-a*s.m);i(h)||i(o)||r(s)||r(e),s.a=Worldcore.v3_add(s.a,h),e.a=Worldcore.v3_add(e.a,o)}for(let e=0;e<this.chains;e++){let s=this.ms[e];0===e?s.v=[0,0,0]:s.v=Worldcore.v3_add(s.v,s.a),s.v=Worldcore.v3_scale(s.v,.9999),s.p=Worldcore.v3_add(s.p,s.v)}this.say("updateDisplay"),this.future(20).step()}}wiggle(){let s=this.ms[this.ms.length-1];s.v=Worldcore.v3_add(s.v,[.01,0,0]),console.log("sag",s)}}],pawnBehaviors:[class PendulumPawn{setup(){this.group||(this.group=new Worldcore.THREE.Group,this.group.name="Chain"),this.shape.add(this.group),this.constructChain(),this.removeEventListener("pointerDoubleDown","onPointerDoubleDown"),this.addEventListener("pointerDoubleDown","nop"),this.listen("updateDisplay","updateDisplay")}constructChain(){let i=this.actor.chains;this.group.children.forEach(s=>{this.group.remove(s)}),this.group.children=[],this.spheres=[...Array(i-1).keys()].map(s=>{var e=new Worldcore.THREE.SphereGeometry(.1,16,16),s=new Worldcore.THREE.MeshStandardMaterial({color:s/i*200*65536});let t=new Worldcore.THREE.Mesh(e,s);return this.group.add(t),t.castShadow=!0,t})}updateDisplay(){this.group&&(this.actor.chains,this.group.children.length);var t=this.actor.ms;if(this.original||(this.original=this.shape.children.find(s=>"Chain"!==s.name)),t)for(let e=0;e<t.length;e++){var i=t[e];let s=e<t.length-1?this.group.children[e]:this.original;s&&s.position.set(...i.p)}}}]}]}}}]);